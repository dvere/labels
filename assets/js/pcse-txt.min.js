function e(e,n,t,F){let r={tab:F};"TBA"!=n&&(n=n.split("/").reverse().join("-"),r.DateRangeStart=r.DateRangeEnd=n,r.SearchOn=5);let i={url:"/portal/Logistics/Orders",xhrFields:{withCredentials:!0},method:"GET",dataType:"html",data:r};$.ajax(i).done(function(e){return $(e).text()}).then(function(n){return $(n).find("tr:contains("+e+")").children().eq(9)}).then(function(e){t.unshift($(e).html().split("<br>").sort().reverse()[0]);var n=function(e){for(var n=`\n^FX ${(new Date).toISOString()}\n^XA\n^DFR:DELIVERY.GRF\n^FO5,5^GB780,1200,4^FS\n^FO5,240^GB780,860,3^FS\n^FO5,420^GB480,180,3^FS\n^FO482,240^GB302,360,3^FS\n^FO5,660^GB780,1,3^FS\n^FO5,820^GB780,1,3^FS\n^FO5,970^GB780,1,3^FS\n^FO215,60^BY2^BCN,150,N^FN0^FS\n^FO5,25^A0N,30^FB780,1,0,C^FN0^FS\n^FO15,275^A0N,140^FB480,1,0,C^FN1^FS\n^FO15,455^A0N,140^FB480,1,0,C^FN2^FS\n^FO500,365^A0N,140^FB280,1,0,C^FN3^FS\n^FO5,615^A0N,40^FB780,1,0,C^FN4^FS\n^FO15,700^A0N,100^FB780,1,0,C^FN6^FS\n^FO150,840^A0N,24^FN4^FS\n^FO150,870^A0N,24^FN5^FS\n^FO150,900^A0N,24^FN6^FS\n^FO15,1000^A0N,100^FB780,1,0,C^FN8^FS\n^FO170,1120^BY2^BCN,55,Y^FN7^FS\n^XZ`,t=e.pop(),F=e[1]+"_"+e[7],r=e.map(function(e,n){return"^FN"+n+"^FD"+e+"^FS"}).join("\n"),i="",a=t;a>0;a--){let e="\n\n^XA^XFR:DELIVERY.GRF\n"+r+"\n^FN8^FDPieces: "+a+" of "+t+"^FS\n^XZ";i+=e}return{file:F,zpl:n+i}}(t);!function(e,n,t="text/plain"){var F=document.createElement("a"),r=new Blob([e],{type:t}),i=window.URL.createObjectURL(r);F.style="display: none",F.href=i,F.download=n,document.body.appendChild(F),F.click(),window.URL.revokeObjectURL(i),F.remove()}(n.zpl,n.file)})}$.when($.ready).then(function(){var n;if("Order"==window.location.pathname.split("/")[3]){var t=$("#OrderStatusId").val();if(141560002==t)n="ReadyForDespatch";else if(141560003==t)n="Despatched";else{if(100001!=t)return;n="Complete"}var F=prompt("Enter number of packages:",1);if(null==F||""==F||isNaN(F))console.log("Input quantity error or cancelled by user");else{var r=$("h3").eq(0).text().trim().split(" ")[2],i=$("nav.account-links").find("li").eq(1).text().trim(),a={BASINGSTOKE:"BS",BECKTON:"CV",BIRMINGHAM:"BP",BRISTOL:"BL",CAMBRIDGE:"CB",GATWICK:"CW",LEEDS:"LD",LETCHWORTH:"LE",MANCHESTER:"MA",MEDWAY:"ME",MILTON:"MK",NEWCASTLE:"NE",NORWICH:"NR",NOTTINGHAM:"NG",PLYMOUTH:"PL",READING:"NB",SLOUGH:"3S",SOUTHAMPTON:"SO",SWINDON:"SW",TELFORD:"TF",WARWICK:"MC"}[i.substr(0,i.indexOf(" ")).toUpperCase()],o={};$(".pcss-order-summary").find(".col-md-5").each(function(e,n){var t=$(".pcss-order-summary").find(".col-md-7").eq(e).text().trim();o[$(n).text()]=t});var N=o["Expected Delivery Date"],l=o["Shipping Address"].split(","),s=l.shift(),d=l.pop();e(r,N,[o["Delivery Route And Stop"].substr(0,4),o["Location Code"],a,s,l,d,r,F],n)}}});